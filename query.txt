
i have a react app and am trying to serve via docker.
api calls from the browser result in 404 error because the calls were directed to http://localhost:3000/api/get_number rather than the expected "http://backend:5000";


vite.config.js:
'''
import { defineConfig } from "vite";
import react from "@vitejs/plugin-react-swc";
import tailwindcss from "@tailwindcss/vite";

const proxyTarget =
  process.env.NODE_ENV === "development"
    ? "http://127.0.0.1:5000"
    : "http://backend:5000";

console.log("\n", process.env.NODE_ENV, "\n", proxyTarget);

export default defineConfig({
  plugins: [react(), tailwindcss()],
  server: {
    host: "0.0.0.0", // Ensures it's accessible from outside the container
    port: 3000, // Make sure the port matches what you're exposing
    proxy: {
      "/api": {
        target: proxyTarget,
        changeOrigin: true,
        secure: false,
        ws: true,
      },
    },
  },
});
'''

dockerfile:
'''
FROM node:22-slim
WORKDIR /client
COPY package.json ./
RUN npm install
COPY . .
ENV NODE_ENV="production"
RUN npm run build
EXPOSE 3000
CMD ["npx", "serve", "dist"]
'''

dockerfile: 
'''
FROM python:3.10-slim
ENV FLASK_APP=app.py
WORKDIR /server
COPY requirements.txt requirements.txt
RUN pip install -r requirements.txt
COPY . .
EXPOSE 5000
CMD [ "flask", "run", "--host=0.0.0.0"]
'''

docker-compose.yml:
'''
version: "3.8"

services:
  frontend:
    build:
      context: ./client
      dockerfile: Dockerfile
    ports:
      - "3000:3000"
    environment:
      - NODE_ENV=production
    networks:
      - app-network

  backend:
    build:
      context: ./server
      dockerfile: Dockerfile
    ports:
      - "5000:5000"
    environment:
      - FLASK_APP=app.py
    networks:
      - app-network

networks:
  app-network:
    driver: bridge
'''


api call function:
'''
  const handleGetName = () => {
    fetch("/api/get_number", {
      headers: {
        "Access-Control-Allow-Origin": "*",
      },
    })
      .then((response) => response.json())
      .then((response) => setShowName(response.number));
  };
  '''
